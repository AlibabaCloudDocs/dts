# 将DTS服务器的IP地址段添加到自建数据库的IP白名单

如果您的自建数据库不是部署在阿里云上，它们可能只接受与特定IP地址建立连接。 在这种情况下，您需要修改自建数据库的安全设置，以允许来自DTS服务器的访问。

## 适用的数据库

当您将某些类型的自建数据库作为源数据库或目标数据库时，您需要修改自建数据库的安全设置，以允许来自DTS服务器的访问。 需要修改安全设置的数据库包括以下类型：有公网IP的自建数据库、无公网IP:Port的数据库（通过数据库网关DG接入）、通过云企业网CEN接入的自建数据库、通过专线/VPN网关/智能接入网关接入的自建数据库。

**说明：** 对于阿里云数据库实例（例如RDS、MongoDB等）或ECS上的自建数据库，您无需手动修改数据库的安全设置。 DTS自动将DTS服务器的IP地址段添加到阿里云数据库实例的IP白名单或ECS实例的安全规则中。

## 判断DTS实例所在地域

您需要根据使用的DTS实例，判断需要为源数据库还是目标数据库所在地域的DTS服务器添加IP白名单。

-   数据迁移实例：选择目标数据库所在的地域，获取对应的IP地址段并将其加入到源和目标数据库的IP白名单。
-   数据订阅实例：选择源数据库所在的地域，获取对应的IP地址段并将其加入到源数据库的IP白名单。
-   数据同步实例：
    -   如果需要允许DTS访问源数据库，请选择源数据库和目标数据库所在的地域，获取对应的IP地址段并将其加入到源数据库的IP白名单。
    -   如果需要允许DTS访问目标数据库，请选择目标数据库所在的地域，获取对应的IP地址段并将其加入到目标数据库的IP白名单。

## 获取DTS服务器的IP地址段

根据DTS访问数据库的网络不同，IP地址段会有所不同。

**可通过公网访问**：如果DTS通过公网访问自建数据库，请参考下表获取相应地域DTS服务器的IP地址段。

**说明：** 数据同步实例不支持同步通过公网访问的自建数据库。

|地域|IP地址段|
|--|-----|
|华东1（杭州）|101.37.14.0/24,114.55.89.0/24,115.29.198.0/24,118.178.120.0/24,118.178.121.0/24,120.26.106.0/24,120.26.116.0/24,120.26.117.0/24,120.26.118.0/24,120.55.192.0/24,120.55.193.0/24,120.55.194.0/24,120.55.241.0/24,121.40.125.0/24,121.196.246.0/24,101.37.12.0/24,101.37.13.0/24,101.37.15.0/24,101.37.25.0/24,47.96.39.0/24,118.31.184.0/24,118.31.165.0/24,118.31.246.0/24,120.55.12.0/24,47.97.7.0/24,47.97.27.142/32,47.97.73.210/32,121.43.162.118/32,121.43.185.141/32,121.196.211.16/32,114.55.125.94/32,121.43.179.168/32,121.43.174.187/32,47.99.171.159/32,47.97.118.150/32,47.98.251.185/32,47.99.43.73/32,47.97.195.167/32,120.27.211.237/32,47.97.125.64/32,47.98.52.255/32,47.97.116.109/32,47.97.119.148/32,47.98.51.78/32,47.97.106.64/32,116.62.172.149/32,120.55.40.134/32,47.98.39.64/32,116.62.197.0/24,121.196.199.0/24,116.62.206.0/24,116.62.208.0/24,116.62.57.0/24,116.62.20.0/24,116.62.64.0/24,116.62.201.0/24,121.196.198.0/24,118.31.43.101,101.37.152.136,118.31.38.161,120.55.60.232,120.55.60.183,101.37.149.3,112.124.237.0/24|
|华东2（上海）|139.196.17.0/24,139.196.18.0/24,139.196.25.0/24,139.196.27.0/24,139.196.154.0/24,139.196.116.0/24,139.196.254.0/24,139.196.166.0/24,106.14.46.0/24,106.14.37.0/24,106.14.36.0/24,106.15.250.0/24,101.132.248.0/24,47.100.95.0/24,106.15.73.0/24,106.15.75.0/24,47.100.137.0/24,106.14.177.89,106.14.178.118,139.196.138.36,106.14.4.132,139.196.92.27,139.196.143.11,139.196.44.156,139.196.6.35,139.196.50.106,139.196.25.56,139.196.47.137,139.196.6.124,139.196.49.138,139.196.41.168,139.196.48.218,139.196.51.72,47.101.194.0/24,47.101.166.0/24,47.101.181.0/24,47.101.177.0/24,47.100.186.0/24,139.196.6.0/24,139.196.138.0/24,139.196.51.0/24,139.196.49.0/24,139.196.50.0/24,106.14.177.0/24,139.196.48.0/24,106.14.178.0/24,106.14.4.0/24,139.196.41.0/24,139.196.44.0/24,139.196.92.0/24,139.196.143.0/24,139.196.47.0/24,47.101.175.0/24,101.132.174.0/24,139.196.52.0/24,47.101.31.0/24,47.100.3.0/24,47.100.160.0/24,47.101.61.0/24,47.101.205.0/24|
|华北1（青岛）|115.28.200.0/24,115.28.216.0/24,115.28.226.0/24,115.28.247.0/24,118.190.133.0/24,120.27.53.0/24,10.31.69.0/24,10.144.88.0/24,10.144.153.0/24,10.161.39.0/24,10.161.59.0/24,10.252.29.0/24,100.104.72.0/24,47.104.10.200,118.190.157.247,47.104.19.209,47.104.105.196,47.104.97.251|
|华北2（北京）|112.126.80.0/24,112.126.87.0/24,112.126.91.0/24,112.126.92.0/24,123.56.108.0/24,123.56.120.0/24,123.56.137.0/24,123.56.148.0/24,123.56.164.0/24,123.57.48.0/24,182.92.153.0/24,182.92.186.0/24,101.200.174.0/24,101.200.160.0/24,101.200.176.0/24,47.94.36.0/24,47.94.47.0/24,101.201.214.0/24,101.201.82.0/24,123.56.182.0/24,101.201.105.0/24,182.92.132.0/24,60.205.157.0/24,101.201.107.0/24,60.205.164.0/24,60.205.165.0/24,59.110.4.0/24,59.110.17.0/24,123.56.186.0/24,60.205.146.0/24,59.110.37.0/24,59.110.19.0/24,60.205.112.0/24,60.205.243.0/24,101.201.108.0/24,59.110.38.0/24,60.205.197.0/24,60.205.166.0/24,101.200.194.0/24,101.200.182.0/24,123.57.204.0/24,101.200.235.0/24,123.57.206.0/24,123.57.65.0/24,47.94.167.117/32,182.92.157.129/32,101.200.39.123/32,101.200.192.4/32,39.105.58.165/32,101.200.213.59/32,59.110.164.0/24,47.94.150.0/24,39.105.56.0/24,47.93.21.0/24,47.93.30.0/24,47.93.24.0/24,60.205.222.0/24,60.205.186.0/24,47.93.22.174/32,47.93.10.168/32,47.94.246.43/32,47.94.94.233/32,47.95.241.173/32,59.110.155.242/32,60.205.230.219/32,101.200.50.74/32,101.201.65.33/32,112.126.96.49/32,112.126.96.184/32,112.126.98.30/32,112.126.99.22/32,112.126.99.87/32,112.126.99.205/32,39.105.247.0/24,8.131.132.0/26|
|华北3（张家口）|47.92.22.0/24,47.92.185.0/26,47.92.185.64/26,47.92.185.128/26,47.92.185.192/26,39.98.96.0/26,39.98.96.128/26,39.98.96.192/26,39.98.96.64/26|
|华北5（呼和浩特）|39.104.29.0/24|
|华南1（深圳）|112.74.0.0/16,120.24.0.0/16,120.25.0.0/16,120.78.6.0/24,120.78.5.0/24,47.115.165.0/24,47.115.166.0/24,47.115.162.0/24,47.115.161.0/24,120.24.65.0/24,120.24.67.0/24,120.24.160.0/24,120.25.215.0/24,120.24.214.0/24,120.24.223.0/24,120.25.124.0/24,120.25.107.0/24,120.25.79.0/24,112.74.211.0/24,120.24.174.0/24,120.24.173.0/24,120.25.150.0/24,112.74.98.0/24,120.25.123.0/24,112.74.97.0/24,47.106.221.0/24,120.78.184.0/24,47.107.118.0/24,47.106.38.0/24,39.108.66.0/24,39.108.110.0/24,47.113.76.192/26|
|中国（香港）|203.88.163.0/24,47.90.37.0/24,47.90.38.0/24,47.89.39.0/24,47.52.111.0/24,47.52.25.202/32,47.91.228.249/32,47.52.166.98/32,47.244.33.65/32,47.244.35.187/32|
|亚太东南 1（新加坡）|47.88.133.0/24,47.88.139.0/24,47.74.206.0/24,47.88.235.0/24,47.88.139.0/24,11.193.8.0/24,10.45.241.0/24,10.45.244.0/24,10.45.245.0/24|
|亚太东南 2（悉尼）|47.91.49.0/24,47.91.50.0/24|
|亚太东南 3（吉隆坡）|47.254.212.0/24,120.55.129.0/24,112.124.140.0/24|
|亚太东南 5（雅加达）|149.129.228.0/24,149.129.229.0/24|
|亚太南部 1（孟买）|149.129.164.0/24,147.139.21.0/24|
|亚太东北 1（东京）|47.91.9.0/24,47.91.13.0/24,47.91.27.0/24|
|美国西部 1（硅谷）|198.11.174.0/24,198.11.175.0/24,47.89.244.175/32|
|美国东部 1（弗吉尼亚）|47.89.170.0/24,47.88.98.0/24,47.250.29.0/24|
|欧洲中部 1（法兰克福）|47.91.82.0/24,47.91.83.0/24,47.91.84.0/24|
|英国（伦敦）|8.208.17.0/24|
|中东东部 1（迪拜）|47.91.102.0/24,47.91.103.0/24|

**通过内网访问**：如果DTS通过虚拟内网或物理内网（如高速通道、VPN网关和智能接入网关）访问自建数据库，请参考下表获取相应地域DTS服务器的IP地址段。

**说明：** 当DTS添加新服务器时，如果不及时更新自建数据库的白名单设置，可能导致DTS无法正常连接数据库。 为了避免此问题，建议您将100.104.0.0/16添加到可通过内网访问的自建数据库的IP白名单。

|地域|IP地址段|
|--|-----|
|华东1（杭州）|100.104.52.0/24,100.104.61.128/26,100.104.244.64/26,100.104.216.192/26|
|华东2（上海）|100.104.205.0/24,100.104.226.128/26|
|华北1（青岛）|100.104.72.0/24,100.104.35.192/26|
|华北2（北京）|100.104.183.0/24,100.104.236.128/26,100.104.227.192/26,100.104.128.192/26|
|华北3（张家口）|100.104.175.0/24|
|华北5（呼和浩特）|100.104.72.0/24|
|华南1（深圳）|100.104.75.64/26,100.104.235.192/26,100.104.205.0/24|
|中国（香港）|100.104.233.0/24,100.104.177.192/26|
|亚太东南 1（新加坡）|100.104.188.0/24,100.104.207.128/26|
|亚太东南 2（悉尼）|100.104.233.0/24|
|亚太东南 3（吉隆坡）|100.104.5.0/24|
|亚太东南 5（雅加达）|100.104.175.0/24|
|亚太南部 1（孟买）|100.104.8.0/24|
|亚太东北 1（东京）|100.104.112.0/24|
|美国西部 1（硅谷）|100.104.175.0/24|
|美国东部 1（弗吉尼亚）|100.104.233.0/24|
|欧洲中部 1（法兰克福）|100.104.5.0/24|
|英国（伦敦）|100.104.133.64/26,100.104.207.128/26|
|中东东部 1（迪拜）|100.104.205.0/24|

## 将IP地址段添加到白名单

获取到IP地址段后，您需要在自建数据库的安全设置中将该IP地址段列入白名单。 添加白名单的具体操作步骤取决于您的系统部署。 例如，如果您的数据库部署了防火墙，您需要配置安全规则以允许IP地址段内的DTS服务器访问您的数据库服务器。 如果您的数据库部署在第三方供应商提供的虚拟机上，您需要配置安全组以允许IP地址段内的DTS服务器访问您的虚拟机。

